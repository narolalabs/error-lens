"use strict";

$.ajaxSetup({
    headers: {
        'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
    }
});

$(document).ready(function() {
	if ( $('.full-log-view').length ) {
		setTimeout(() => {
		    hljs.highlightAll();
		}, 1000);
	}
});

$(document).on('click', '.view-error', function(event) {
	event.preventDefault();
	event.stopPropagation()
	let url = $(this).attr('href');

	if ( url ) {
		$.ajax({
			url: url,
			type: 'get',
			dataType: 'json',
			catch: false,
			async: false,
			success: function (response) {
				if ( response.status ) {
					makeModal('view-error-modal', 'view-error-modal w-75', response.data.view, 'modal-lg', true);
					
					setTimeout(() => {
					    hljs.highlightAll();
					}, 1000);

				}
			}
		});	
	}
});

$(document).on('click', '.view-more', function(event) {
    event.preventDefault();
    $('.exception-trace-wrapper').toggleClass('in')

    $('.exception-trace-wrapper').hasClass('in') ?
    	$(this).html('View less') :
    	$(this).html('View more');

});
